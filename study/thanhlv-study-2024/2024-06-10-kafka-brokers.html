<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    
    <title>Kafka Brokers là gì ? | Yêu công nghệ - Khám Phá Công Nghệ - Thanhlv.com</title>
    
    <meta name="generator" content="VitePress v1.0.0-rc.33">
    <link rel="preload stylesheet" href="/assets/style.LovHjO5o.css" as="style">
    
    <script type="module" src="/assets/app.LARO7oMx.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.bvIUbFQP.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.9xwLhOZU.js">
    <link rel="modulepreload" href="/assets/chunks/theme.SyD7j4b9.js">
    <link rel="modulepreload" href="/assets/study_thanhlv-study-2024_2024-06-10-kafka-brokers.md.McwhZlSb.lean.js">
    <link rel="prefetch" href="/assets/chunks/VPAlgoliaSearchBox.UqyQ9lcQ.js">
    <link rel="icon" href="/logo.svg">
    <meta name="viewport" content="viewport-fit=contain, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=10.0, user-scalable=yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#a78a3f">
    <meta property="og:type" content="website">
    <meta name="twitter:site" content="@thanhlv">
    <meta name="twitter:card" content="summary">
    <link rel="icon" sizes="16x16" href="/images/favicon/favicon-16x16.png">
    <link rel="icon" sizes="32x32" href="/images/favicon/favicon-32x32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon/apple-touch-icon.png">
    <link rel="manifest" sizes="180x180" href="/images/favicon/site.webmanifest">
    <script>(()=>{const e=(o,r,t=!1)=>{const s=localStorage.getItem(o);(s?s!=="false":t)&&document.documentElement.classList.add(r)};e("vue-docs-prefer-composition","prefer-composition",!0),e("vue-docs-prefer-sfc","prefer-sfc",!0),window.__VUE_BANNER_ID__="herodevs-vue2-nes",e(`vue-docs-banner-${__VUE_BANNER_ID__}`,"banner-dismissed")})();</script>
    <script src="https://cdn.usefathom.com/script.js" data-site="XNOLWPLB" data-spa="auto" defer></script>
    <script src="https://www.googletagmanager.com/gtag/js?id=G-DHC69X8F8N" async></script>
    <script src="https://images.dmca.com/Badges/DMCABadgeHelper.min.js" async></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-DHC69X8F8N");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta property="og:image" content="/images/thumbnail.png" itemprop="thumbnailUrl">
    <meta property="og:url" content="study/thanhlv-study-2024/2024-06-10-kafka-brokers.html" itemprop="url">
    <meta property="og:title" content="Kafka Brokers là gì ?" itemprop="headline">
    <meta property="og:description" content="Kafka Brokers là gì ?" itemprop="description">
    <meta name="description" content="Kafka Brokers là gì ?">
    <link rel="preload" href="/assets/inter-roman-latin.bvIUbFQP.woff2" as="font" type="font/woff2" crossorigin="">
  </head>
  <body>
    <div id="app"><div class="VPApp" data-v-06370823><!--[--><span tabindex="-1" data-v-e28efdbe></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-e28efdbe>Skip to content</a><!--]--><!----><!--[--><!--]--><header class="VPNav nav-bar" data-v-06370823 data-v-eb8a431b><div class="VPNavBar" data-v-eb8a431b data-v-2a04ed76><div class="container" data-v-2a04ed76><a class="VPNavBarTitle VPNavBarTitleColor" href="/" data-v-2a04ed76 data-v-8e702bed><!--[--><span class="text" data-v-8e702bed>Thanhlv</span><!--]--></a><div class="content" data-v-2a04ed76><div class="VPNavBarSearch search" data-v-2a04ed76><div id="docsearch"><button type="button" class="DocSearch DocSearch-Button" aria-label="Tìm kiếm"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Tìm kiếm</span></span><!----></button></div></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-2a04ed76 data-v-0251f2dd><span id="main-nav-aria-label" class="visually-hidden" data-v-0251f2dd>Main Navigation</span><!--[--><!--[--><a class="vt-link link VPNavBarMenuLink" href="/blog/gioi-thieu.html" data-v-0251f2dd data-v-d94b69c8><!--[-->Blog<!--]--><!----></a><!--]--><!--[--><a class="vt-link link VPNavBarMenuLink" href="/short-blog/gioi-thieu.html" data-v-0251f2dd data-v-d94b69c8><!--[-->Short Blog<!--]--><!----></a><!--]--><!--[--><div class="vt-flyout VPNavBarMenuGroup active" data-v-0251f2dd data-v-d297c9e4><button type="button" class="vt-flyout-button" aria-haspopup="true" aria-expanded="false"><!--[--><span class="vt-flyout-button-text">Study <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-flyout-button-text-icon"><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span><!--]--></button><div class="vt-flyout-menu"><div class="vt-menu"><div class="vt-menu-items"><!--[--><!--[--><a class="vt-link link vt-menu-link" href="/study/thanhlv-study-2024/gioi-thieu-ve-muc-tieu-hoc-tap-be-nam-2024-cua-thanh-lv.html"><!--[-->Học tập BE Thanhlv 2024<!--]--><!----></a><!--]--><!--[--><a class="vt-link link vt-menu-link" href="/study/tieng-anh/gioi-thieu.html"><!--[-->Tiếng anh<!--]--><!----></a><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="vt-flyout VPNavBarMenuGroup" data-v-0251f2dd data-v-d297c9e4><button type="button" class="vt-flyout-button" aria-haspopup="true" aria-expanded="false"><!--[--><span class="vt-flyout-button-text">About <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-flyout-button-text-icon"><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span><!--]--></button><div class="vt-flyout-menu"><div class="vt-menu"><div class="vt-menu-items"><!--[--><!--[--><a class="vt-link link vt-menu-link" href="/about/author/thanhlv-vi.html"><!--[-->Thanhlv<!--]--><!----></a><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--><!----></nav><div class="VPNavBarAppearance appearance" data-v-2a04ed76 data-v-3e577afb><button class="vt-switch vt-switch-appearance" type="button" role="switch" aria-label="Toggle dark mode" aria-checked="false" data-v-3e577afb><span class="vt-switch-check"><span class="vt-switch-icon"><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-sun"><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-moon"><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="vt-flyout VPNavBarExtra extra" data-v-2a04ed76 data-v-449c409e><button type="button" class="vt-flyout-button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation"><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-flyout-button-icon"><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg><!--]--></button><div class="vt-flyout-menu"><div class="vt-menu"><!----><!--[--><!--[--><div class="vt-menu-group" data-v-449c409e><div class="vt-menu-item item" data-v-449c409e><p class="vt-menu-label" data-v-449c409e>Appearance</p><div class="vt-menu-action action" data-v-449c409e><button class="vt-switch vt-switch-appearance" type="button" role="switch" aria-label="Toggle dark mode" aria-checked="false" data-v-449c409e><span class="vt-switch-check"><span class="vt-switch-icon"><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-sun"><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-switch-appearance-moon"><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><button type="button" class="vt-hamburger VPNavBarHamburger hamburger" aria-label="Mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-2a04ed76 data-v-7268c6dd><span class="vt-hamburger-container"><span class="vt-hamburger-top"></span><span class="vt-hamburger-middle"></span><span class="vt-hamburger-bottom"></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-06370823 data-v-5566fe4f><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-5566fe4f><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-5566fe4f><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-5566fe4f>Menu</span></button><!----><div class="VPLocalNavOutlineDropdown" style="--vt-vh:0px;" data-v-5566fe4f data-v-f354055f><button class="" data-v-f354055f>Trên trang này <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-f354055f><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></button><!----></div></div><aside class="VPSidebar" data-v-06370823 data-v-e0208b58><nav id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-e0208b58><!--[--><!--[--><!----><!--]--><!--]--><span id="sidebar-aria-label" class="visually-hidden" data-v-e0208b58>Sidebar Navigation</span><!--[--><div class="group" data-v-e0208b58><section class="VPSidebarGroup" data-v-e0208b58 data-v-c0b17f2f><div class="title" data-v-c0b17f2f><h2 class="title-text" data-v-c0b17f2f>Giới thiệu</h2></div><!--[--><a class="link" href="/study/thanhlv-study-2024/gioi-thieu-ve-muc-tieu-hoc-tap-be-nam-2024-cua-thanh-lv.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Mục tiêu công nghệ của Thanhlv năm 2024</p></a><!--]--></section></div><div class="group" data-v-e0208b58><section class="VPSidebarGroup" data-v-e0208b58 data-v-c0b17f2f><div class="title" data-v-c0b17f2f><h2 class="title-text" data-v-c0b17f2f>1. Internet</h2></div><!--[--><a class="link" href="/study/thanhlv-study-2024/2024-03-14-Internet-Internet-hoat-dong-nhu-the-nao.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Internet hoạt động như thế nào?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-03-18-world-wide-web-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>World wide web là gì ?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-04-02-htpp-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>HTTP là gì?</p></a><!--]--></section></div><div class="group" data-v-e0208b58><section class="VPSidebarGroup" data-v-e0208b58 data-v-c0b17f2f><div class="title" data-v-c0b17f2f><h2 class="title-text" data-v-c0b17f2f>2. Message and event stream</h2></div><!--[--><a class="link" href="/study/thanhlv-study-2024/2024-04-15-message-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Message là gì ?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-04-15-message-queue-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Message queue là gì ?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-04-16-event-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Event là gì ?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-04-19-stream-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Stream là gì ?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-04-21-event-stream-va-event-stream-platform-la-gi.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Event stream và Event stream platform là gì ?</p></a><a class="link" href="/study/thanhlv-study-2024/2024-04-24-so-sanh-message-va-event.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>So sánh Message và Event.</p></a><!--]--></section></div><div class="group" data-v-e0208b58><section class="VPSidebarGroup" data-v-e0208b58 data-v-c0b17f2f><div class="title" data-v-c0b17f2f><h2 class="title-text" data-v-c0b17f2f>2.1 Kafka</h2></div><!--[--><a class="link" href="/study/thanhlv-study-2024/2024-04-25-tim-hieu-lich-su-va-muc-dich-cua-kafka.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Tìm hiểu lịch sử và mục đích của kafka</p></a><a class="link" href="/study/thanhlv-study-2024/2024-05-16-cai-dat-kafka-voi-zookeeper-hoac-KRaft.html" data-v-c0b17f2f data-v-c0067341><p class="link-text" data-v-c0067341>Cài đặt Kafka với Zookeeper và Kraft</p></a><!--]--></section></div><!--]--><!--[--><!--]--></nav></aside><div id="VPContent" class="VPContent has-sidebar" data-v-06370823 data-v-702efdcb><div class="VPContentDoc has-aside has-sidebar" data-v-702efdcb data-v-81aadc3d><div class="container" data-v-81aadc3d><div class="aside" data-v-81aadc3d><div class="aside-container" data-v-81aadc3d><!--[--><!--]--><div class="VPContentDocOutline" data-v-81aadc3d data-v-84f7432a><div class="outline-marker" data-v-84f7432a></div><div class="outline-title" data-v-84f7432a>Trên trang này</div><nav aria-labelledby="doc-outline-aria-label" data-v-84f7432a><span id="doc-outline-aria-label" class="visually-hidden" data-v-84f7432a>Table of Contents for current page</span><ul class="root" data-v-84f7432a data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#kafka-brokers-la-gi" style="" data-v-f0284818>Kafka Brokers là gì ?</a><!----></li><li data-v-f0284818><a class="outline-link" href="#vai-tro-cua-kafka-brokers-voi-produce-khi-produce-gui-record-đen-brokers" style="" data-v-f0284818>Vai trò của Kafka Brokers với Produce khi Produce gửi record đến Brokers</a><!----></li><li data-v-f0284818><a class="outline-link" href="#vai-tro-cua-kafka-brokers-voi-consumer-khi-consumer-nhan-record-tu-brokers" style="" data-v-f0284818>Vai trò của Kafka Brokers với Consumer khi Consumer nhận record từ Brokers</a><!----></li><li data-v-f0284818><a class="outline-link" href="#topics-va-partitions" style="" data-v-f0284818>Topics và partitions</a><ul class="nested" data-v-f0284818 data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#topics" style="" data-v-f0284818>Topics</a><!----></li><li data-v-f0284818><a class="outline-link" href="#partitions" style="" data-v-f0284818>partitions</a><ul class="nested" data-v-f0284818 data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#cach-kafka-broker-map-record-đen-partition" style="" data-v-f0284818>Cách Kafka Broker map record đến partition.</a><!----></li><!--]--></ul></li><li data-v-f0284818><a class="outline-link" href="#offsets" style="" data-v-f0284818>Offsets</a><!----></li><li data-v-f0284818><a class="outline-link" href="#xac-đinh-so-luong-partition-su-dung" style="" data-v-f0284818>Xác định số lượng partition sử dụng</a><!----></li><li data-v-f0284818><a class="outline-link" href="#tao-mot-topic" style="" data-v-f0284818>Tạo một topic</a><!----></li><li data-v-f0284818><a class="outline-link" href="#segments" style="" data-v-f0284818>Segments</a><ul class="nested" data-v-f0284818 data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#vi-du-ve-segments-cua-mot-partition-index" style="" data-v-f0284818>Ví dụ về segments của một partition index.</a><ul class="nested" data-v-f0284818 data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#cac-file-segment" style="" data-v-f0284818>Các file Segment</a><!----></li><li data-v-f0284818><a class="outline-link" href="#file-leader-epoch-checkpoint" style="" data-v-f0284818>File leader-epoch-checkpoint</a><!----></li><li data-v-f0284818><a class="outline-link" href="#file-partition-metadata" style="" data-v-f0284818>File partition.metadata</a><!----></li><li data-v-f0284818><a class="outline-link" href="#segments-position-index" style="" data-v-f0284818>Segments position index</a><!----></li><!--]--></ul></li><!--]--></ul></li><li data-v-f0284818><a class="outline-link" href="#cau-hinh-cleanup-policy" style="" data-v-f0284818>Cấu hình cleanup.policy</a><ul class="nested" data-v-f0284818 data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#cac-gia-tri-cua-cleanup-policy" style="" data-v-f0284818>Các giá trị của cleanup.policy</a><!----></li><li data-v-f0284818><a class="outline-link" href="#_2-cach-thuc-quan-ly-record-cleanup-policy-delete" style="" data-v-f0284818>2 cách thức quản lý Record cleanup.policy=delete</a><ul class="nested" data-v-f0284818 data-v-f0284818><!--[--><li data-v-f0284818><a class="outline-link" href="#retention-time-based-policy-chinh-sach-dua-tren-thoi-gian-luu-tru" style="" data-v-f0284818>Retention Time-Based Policy (Chính sách dựa trên thời gian lưu trữ)</a><!----></li><li data-v-f0284818><a class="outline-link" href="#retention-size-based-policy-chinh-sach-dua-tren-kich-thuoc-du-lieu" style="" data-v-f0284818>Retention Size-Based Policy (Chính sách dựa trên kích thước dữ liệu)</a><!----></li><li data-v-f0284818><a class="outline-link" href="#ket-hop-ca-time-based-policy-va-size-based-policy" style="" data-v-f0284818>Kết hợp cả Time-Based Policy và Size-Based Policy</a><!----></li><li data-v-f0284818><a class="outline-link" href="#luu-tru-du-lieu-mai-mai" style="" data-v-f0284818>Lưu trữ dữ liệu mãi mãi.</a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul></li><li data-v-f0284818><a class="outline-link" href="#tiered-storage" style="" data-v-f0284818>Tiered storage</a><!----></li><li data-v-f0284818><a class="outline-link" href="#cluster-metadata" style="" data-v-f0284818>Cluster Metadata</a><!----></li><li data-v-f0284818><a class="outline-link" href="#leaders-and-followers" style="" data-v-f0284818>Leaders and followers</a><!----></li><li data-v-f0284818><a class="outline-link" href="#replication" style="" data-v-f0284818>Replication</a><!----></li><li data-v-f0284818><a class="outline-link" href="#mot-so-luu-y-ve-kafka-brokers" style="" data-v-f0284818>Một số lưu ý về Kafka Brokers</a><!----></li><!--]--></ul></nav></div><!--[--><!--[--><!--[--><div><a class="sponsors-aside-text">Tác giả</a><div class="VPTeamMembers small count-1" data-v-efccf3f0><div class="container" data-v-efccf3f0><!--[--><div class="item" data-v-efccf3f0><article class="VPTeamMembersItem small" data-v-efccf3f0 data-v-4c50b85b><div class="profile" data-v-4c50b85b><figure class="avatar" data-v-4c50b85b><img class="avatar-img" src="/images/avatar/thanhlv.jpg" alt="Lê Văn Thành" data-v-4c50b85b></figure><div class="data" data-v-4c50b85b><h1 class="name" data-v-4c50b85b>Lê Văn Thành</h1><p class="affiliation" data-v-4c50b85b><span class="title" data-v-4c50b85b>Java engineer và App engineer tại Line</span><!----><!----></p><!----><div class="links" data-v-4c50b85b><div class="VPSocialLinks" data-v-4c50b85b data-v-a14f2e61><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lethanh9398" aria-label="github" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://linkedin.com/in/thanhlv-com" aria-label="linkedin" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a><a class="VPSocialLink no-icon" href="https://www.facebook.com/lethanh9398" aria-label="facebook" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Facebook</title><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a><!--]--></div></div></div></div><!----></article></div><!--]--></div></div></div><!--]--><!--]--><!--]--><!----><!--[--><!--]--></div></div><div class="content" data-v-81aadc3d><!--[--><!--]--><main data-v-81aadc3d><div class="author" data-v-81aadc3d><div class="aside-container" style="margin:auto;text-align:center;width:auto;" data-v-81aadc3d><!--[--><!--[--><!--[--><div><a class="sponsors-aside-text">Tác giả</a><div class="VPTeamMembers small count-1" data-v-efccf3f0><div class="container" data-v-efccf3f0><!--[--><div class="item" data-v-efccf3f0><article class="VPTeamMembersItem small" data-v-efccf3f0 data-v-4c50b85b><div class="profile" data-v-4c50b85b><figure class="avatar" data-v-4c50b85b><img class="avatar-img" src="/images/avatar/thanhlv.jpg" alt="Lê Văn Thành" data-v-4c50b85b></figure><div class="data" data-v-4c50b85b><h1 class="name" data-v-4c50b85b>Lê Văn Thành</h1><p class="affiliation" data-v-4c50b85b><span class="title" data-v-4c50b85b>Java engineer và App engineer tại Line</span><!----><!----></p><!----><div class="links" data-v-4c50b85b><div class="VPSocialLinks" data-v-4c50b85b data-v-a14f2e61><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lethanh9398" aria-label="github" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://linkedin.com/in/thanhlv-com" aria-label="linkedin" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a><a class="VPSocialLink no-icon" href="https://www.facebook.com/lethanh9398" aria-label="facebook" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Facebook</title><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a><!--]--></div></div></div></div><!----></article></div><!--]--></div></div></div><!--]--><!--]--><!--]--></div></div><div style="position:relative;" class="vt-doc study" data-v-81aadc3d><div><nav class="table-of-contents"><ul><li><a href="#kafka-brokers-la-gi">Kafka Brokers là gì ?</a></li><li><a href="#vai-tro-cua-kafka-brokers-voi-produce-khi-produce-gui-record-đen-brokers">Vai trò của Kafka Brokers với Produce khi Produce gửi record đến Brokers</a></li><li><a href="#vai-tro-cua-kafka-brokers-voi-consumer-khi-consumer-nhan-record-tu-brokers">Vai trò của Kafka Brokers với Consumer khi Consumer nhận record từ Brokers</a></li><li><a href="#topics-va-partitions">Topics và partitions</a><ul><li><a href="#topics">Topics</a></li><li><a href="#partitions">partitions</a><ul><li><a href="#cach-kafka-broker-map-record-đen-partition">Cách Kafka Broker map record đến partition.</a></li></ul></li><li><a href="#offsets">Offsets</a></li><li><a href="#xac-đinh-so-luong-partition-su-dung">Xác định số lượng partition sử dụng</a></li><li><a href="#tao-mot-topic">Tạo một topic</a></li><li><a href="#segments">Segments</a><ul><li><a href="#vi-du-ve-segments-cua-mot-partition-index">Ví dụ về segments của một partition index.</a><ul><li><a href="#cac-file-segment">Các file Segment</a></li><li><a href="#file-leader-epoch-checkpoint">File leader-epoch-checkpoint</a></li><li><a href="#file-partition-metadata">File partition.metadata</a></li><li><a href="#segments-position-index">Segments position index</a></li></ul></li></ul></li><li><a href="#cau-hinh-cleanup-policy">Cấu hình cleanup.policy</a><ul><li><a href="#cac-gia-tri-cua-cleanup-policy">Các giá trị của cleanup.policy</a></li><li><a href="#_2-cach-thuc-quan-ly-record-cleanup-policy-delete">2 cách thức quản lý Record cleanup.policy=delete</a><ul><li><a href="#retention-time-based-policy-chinh-sach-dua-tren-thoi-gian-luu-tru">Retention Time-Based Policy (Chính sách dựa trên thời gian lưu trữ)</a></li><li><a href="#retention-size-based-policy-chinh-sach-dua-tren-kich-thuoc-du-lieu">Retention Size-Based Policy (Chính sách dựa trên kích thước dữ liệu)</a></li><li><a href="#ket-hop-ca-time-based-policy-va-size-based-policy">Kết hợp cả Time-Based Policy và Size-Based Policy</a></li><li><a href="#luu-tru-du-lieu-mai-mai">Lưu trữ dữ liệu mãi mãi.</a></li></ul></li></ul></li></ul></li><li><a href="#tiered-storage">Tiered storage</a></li><li><a href="#cluster-metadata">Cluster Metadata</a></li><li><a href="#leaders-and-followers">Leaders and followers</a></li><li><a href="#replication">Replication</a></li><li><a href="#mot-so-luu-y-ve-kafka-brokers">Một số lưu ý về Kafka Brokers</a></li></ul></nav><h1 id="overview-bai-viet-ve-kafka-brokers-la-gi" tabindex="-1">Overview bài viết về Kafka Brokers là gì ? <a class="header-anchor" href="#overview-bai-viet-ve-kafka-brokers-la-gi" aria-label="Permalink to &quot;Overview bài viết về Kafka Brokers là gì ?&quot;">​</a></h1><ul><li>Bài này sẽ giải thích cách kafka Broker hoạt động và lưu trữ trong Kafka event streaming platform</li><li>Mô tả cách Kafka Brokers xử lý các yêu cầu từ client cho việc ghi và đọc records.</li><li>Hiểu về Topic và Partitions</li><li>Sử dụng JMX metrics để kiểm tra Brokers</li></ul><h2 id="kafka-brokers-la-gi" tabindex="-1">Kafka Brokers là gì ? <a class="header-anchor" href="#kafka-brokers-la-gi" aria-label="Permalink to &quot;Kafka Brokers là gì ?&quot;">​</a></h2><ul><li>Kafka Brokers hay có thể gọi là Kafka server trong Kafka architecture và nó sẽ đóng vai trò lưu trữ dữ liệu(Storage layer) và nó có thể chạy thành một cluster và nó có thể mở rộng ra nhiều data centers. <img src="/assets/kafka-architecture-view.B_rra7lS.png" alt="kafka-architecture-view.png"></li><li>Kafka Brokers chịu trách nghiệm quản lý dữ liệu( Bao gồm lưu trữ, đọc và replication(Tạo bản sao để sao lưu) ), quản lý topic và partition và quản lý offset.</li><li>Tất nhiên, Kafka Brokers cũng nhận và xử lý trực tiếp các request từ client. <img src="/assets/kafka-handler-request.tA_aT67K.jpg" alt="kafka-handler-request.jpg"></li></ul><h2 id="vai-tro-cua-kafka-brokers-voi-produce-khi-produce-gui-record-đen-brokers" tabindex="-1">Vai trò của Kafka Brokers với Produce khi Produce gửi record đến Brokers <a class="header-anchor" href="#vai-tro-cua-kafka-brokers-voi-produce-khi-produce-gui-record-đen-brokers" aria-label="Permalink to &quot;Vai trò của Kafka Brokers với Produce khi Produce gửi record đến Brokers&quot;">​</a></h2><ul><li>Khi Produce muốn gửi Record đến Broker, Client Produce gửi records đến Broker đeer lưu trữ và consumer client có thể đọc các record đó sau. <img src="/assets/kafka-produce.MttxNzo5.jpg" alt="kafka-produce.jpg"> Hình ảnh phía trên mô tả Produce gửi record đến Brokers, trong thực tế, nhiều Client Produce sẽ giao tiếp với 1 số các Brokers trong cụm.</li></ul><h2 id="vai-tro-cua-kafka-brokers-voi-consumer-khi-consumer-nhan-record-tu-brokers" tabindex="-1">Vai trò của Kafka Brokers với Consumer khi Consumer nhận record từ Brokers <a class="header-anchor" href="#vai-tro-cua-kafka-brokers-voi-consumer-khi-consumer-nhan-record-tu-brokers" aria-label="Permalink to &quot;Vai trò của Kafka Brokers với Consumer khi Consumer nhận record từ Brokers&quot;">​</a></h2><p>Sau khi nói về yêu cầu của Produce chúng ta sẽ nói đến Consumer.</p><ul><li>Consumer client đưa ra yêu cầu đến Broker để đọc(Sử dụng) các Record từ một topic được các Produce gửi trước đó đên Broker. <img src="/assets/kafka-Consumer.PLcOqiQl.jpg" alt="kafka-Consumer.jpg"></li><li>Một điều quan trọng là sử dụng Record sẽ không làm ảnh hưởng đến việc lưu dữ liệu(Không bị mất sau khi đọc) hoặc việc sử dụng Record bởi các Consumer khác(Các consumer khác vẫn có thể đọc)</li></ul><h2 id="topics-va-partitions" tabindex="-1">Topics và partitions <a class="header-anchor" href="#topics-va-partitions" aria-label="Permalink to &quot;Topics và partitions&quot;">​</a></h2><h3 id="topics" tabindex="-1">Topics <a class="header-anchor" href="#topics" aria-label="Permalink to &quot;Topics&quot;">​</a></h3><ul><li>Kafka brokers sử dụng File system để lưu trữ bằng cách nối thêm các Record đến cuối cùng file trong một topic.</li><li>Một topic đại diện cho tên của Folder chưa tệp Kafka nối thêm các Record <img src="/assets/kafka-topic-1.AVPSldcv.jpg" alt="kafka-topic-1.jpg"></li><li>Kafka Brokers sẽ nhận key-value message dưới dạng raw byte, lưu trữ và phục vụ các yêu cầu đọc với cùng định dạng(Raw data). <ul><li>Kafka Brokers không biết về data type của Record(Chỉ nhận được các byte), bằng cách làm việc với raw byte, Brokers không mất thời gian deserializing hoặc serializing dữ liệu nên mạng lại hiệu suất cao hơn.</li></ul></li></ul><h3 id="partitions" tabindex="-1">partitions <a class="header-anchor" href="#partitions" aria-label="Permalink to &quot;partitions&quot;">​</a></h3><ul><li>Các topic sẽ đươc partition, một Partition là một số nguyên(number) bắt đầu từ 0. Vì vậy nếu một topic có 3 partition thì sẽ có số partition là 0, 1, 2.</li><li>Kafka brokers gắn số partition và đuôi của folder topic với format <code>{Topic name}-{partition number}</code>. <ul><li>Ví dụ một Topic tên <code>my-topic-2</code> có <code>5</code> partition thì tên sẽ như sau : <code>my-topic-2-0</code>, <code>my-topic-2-1</code>, <code>my-topic-2-2</code>, <code>my-topic-2-3</code>, , <code>my-topic-2-4</code>, <img src="/assets/kafka-partition-number.H1MC9uuH.jpg" alt="kafka-partition-number.jpg"></li></ul></li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>│   ....</span></span>
<span class="line"><span>│   recovery-point-offset-checkpoint</span></span>
<span class="line"><span>│   replication-offset-checkpoint</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├───my-topic-2-0</span></span>
<span class="line"><span>│       00000000000000000000.index</span></span>
<span class="line"><span>│       00000000000000000000.log</span></span>
<span class="line"><span>│       00000000000000000000.timeindex</span></span>
<span class="line"><span>│       leader-epoch-checkpoint</span></span>
<span class="line"><span>│       partition.metadata</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├───my-topic-2-1</span></span>
<span class="line"><span>│       00000000000000000000.index</span></span>
<span class="line"><span>│       00000000000000000000.log</span></span>
<span class="line"><span>│       00000000000000000000.timeindex</span></span>
<span class="line"><span>│       leader-epoch-checkpoint</span></span>
<span class="line"><span>│       partition.metadata</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├───my-topic-2-2</span></span>
<span class="line"><span>│       00000000000000000000.index</span></span>
<span class="line"><span>│       00000000000000000000.log</span></span>
<span class="line"><span>│       00000000000000000000.timeindex</span></span>
<span class="line"><span>│       leader-epoch-checkpoint</span></span>
<span class="line"><span>│       partition.metadata</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├───my-topic-2-3</span></span>
<span class="line"><span>│       00000000000000000000.index</span></span>
<span class="line"><span>│       00000000000000000000.log</span></span>
<span class="line"><span>│       00000000000000000000.timeindex</span></span>
<span class="line"><span>│       leader-epoch-checkpoint</span></span>
<span class="line"><span>│       partition.metadata</span></span>
<span class="line"><span>│</span></span>
<span class="line"><span>├───my-topic-2-4</span></span>
<span class="line"><span>│      00000000000000000000.index</span></span>
<span class="line"><span>│      00000000000000000000.log</span></span>
<span class="line"><span>│      00000000000000000000.timeindex</span></span>
<span class="line"><span>│      leader-epoch-checkpoint</span></span>
<span class="line"><span>│      partition.metadata</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><ul><li>Nhìn vào folder chúng ta có thể dễ hiểu được với tên topic là một nhóm dữ liệu và partititon là các đơn vị lưu trữ.</li><li>Trong hầu hết các case, số lượng của Partition càng cao thì throughput(Thông lượng) sẽ càng cao.</li></ul><h4 id="cach-kafka-broker-map-record-đen-partition" tabindex="-1">Cách Kafka Broker map record đến partition. <a class="header-anchor" href="#cach-kafka-broker-map-record-đen-partition" aria-label="Permalink to &quot;Cách Kafka Broker map record đến partition.&quot;">​</a></h4><p>Thực tế việc xác định partition sẽ được lầm ở bên Client.</p><ul><li>Đã có 1 blog viết chi tiết ở đây : <a href="./../../blog/2024-08-07-Kafka-producer-da-khong-con-Round-Robin-Partition-voi-key-null.html">Click vào đây để xem</a></li></ul><h3 id="offsets" tabindex="-1">Offsets <a class="header-anchor" href="#offsets" aria-label="Permalink to &quot;Offsets&quot;">​</a></h3><ul><li>Khi broker thêm một Record nó sẽ thêm một <code>id</code> được gọi là <code>offset</code>. Một <code>offset</code> sẽ bắt đầu từ <code>0</code> và là number, nó sẽ tặng lên 1 mỗi khi thêm một Record. <img src="/assets/kafka-offset.sMIJqZq4.png" alt="kafka-offset.png"></li><li>Vì các Record mới luôn được thêm ở cuối của file, nên nó được sắp xếp theo offset.</li><li>Kafka đảm bảo Record order được sẵp xếp theo thứ tự trên cùng một partition chứ không phải trên các partition khác.</li></ul><details class="details custom-block"><summary>Ví dụ</summary><p>Có một topic với partition và có 10 Record.</p><ul><li>Partition 1: R1 (Offset 0) , R3(Offset 2) , R6(Offset 5), R7(Offset 6)</li><li>Partition 2:, R2(Offset 1), R4(Offset 3), R5(Offset 4), R8(Offset 7), R9(Offset 8), R10(Offset 9)</li></ul><p>Partition 1 và 2 sẽ có thứ tự offset tăng dần.</p></details><p>Consumer sử dụng <code>offset</code> để xác định vị trí của Record họ đã sử dụng, bằng cách này Consumer sẽ tìm các Record có <code>offset</code> cao hơn đã được Consumer đọc. <img src="/assets/kafka-offset-2.kQgsXxuz.png" alt="kafka-offset-2.png"></p><h3 id="xac-đinh-so-luong-partition-su-dung" tabindex="-1">Xác định số lượng partition sử dụng <a class="header-anchor" href="#xac-đinh-so-luong-partition-su-dung" aria-label="Permalink to &quot;Xác định số lượng partition sử dụng&quot;">​</a></h3><ul><li>Việc chọn số lượng partition khi tạo một topic là một điều khó khắn, nó là cả một nghệ thuật.</li><li>Một trong nhưng cân nhắc quan trọng là đầu tiên là <strong>lượng dữ liệu chạy chảy vào topic đó</strong>. Nhiều data thì chúng ta có thể có nhiều partition hơn để throughput(Thông lượng) cao hơn, tuy nhiên nhiều partition chúng ta cũng sẽ có những đánh đổi nhất định. <ul><li>Tăng số lượng partition sẽ tăng số lượng TCP connect và open file. Và thời gian để Consumer xử lý một Record cũng là một điều ảnh hưởng đến throughput. Nếu thời gian xử lý cần rất nhiều thì việc thêm partition có thể hữu ích nhưng việc xử lý chậm vẫn làm hiệu xuất không được tốt.</li></ul></li><li>Bắt đầu tốt nhất chúng ta nên sử dụng càng ít partition càng tốt. Bởi vì chúng ta có thể tăng số lượng partition nhưng không thể giảm partition.</li><li>Nếu khi tạo topic chúng ta có thể xác định số lượng Consumer thì chúng ta nên cài đặt partition bằng với số lượng của consumer. Điều này là best cho phiên bản kafk &lt; 2.4 bởi vì các phiên bản cũ sẽ <code>Round-robin</code> các partition nhưng ở phiên bản &gt;= 2.4 thì đã random partiton cho mỗi batch của topic.</li><li>Nếu topic này có thẻ Chúng ta sẽ có 1 chủ đề chi tiết hơn về điều này.</li></ul><h3 id="tao-mot-topic" tabindex="-1">Tạo một topic <a class="header-anchor" href="#tao-mot-topic" aria-label="Permalink to &quot;Tạo một topic&quot;">​</a></h3><ul><li>Để tạo một topic mới chúng ta có thể sử dụng cmd <code>kafka-topics</code> với param <code>--create</code>.</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>kafka-topics --create --if-not-exists --topic first-topic\ #1</span></span>
<span class="line"><span>--bootstrap-server localhost:9092\ #2 </span></span>
<span class="line"><span>--replication-factor 1\ #3  </span></span>
<span class="line"><span>--partitions 1 #4</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><code>#1</code><ul><li>Với <code>kafka-topics</code> là câu lệnh để khởi chạy một <code>cmd</code></li><li><code>--create</code> là param để mong muốn tạo mới một topic với và <code>--if-not-exists</code> là param tạo nếu topic chưa tồn tại, còn đã tồn tại sẽ bỏ qua. (Nếu không có cờ này, nếu đã tồn tại sẽ trả về lỗi ngoại lệ <code>Error while executing topic command : Topic &#39;first-topic&#39; already exists.</code> )</li><li><code>--topic</code> là param để xác định tên topic</li><li><code>first-topic</code> là tên topic</li></ul></li><li><code>#2</code> với <code>--bootstrap-server</code> là danh sách server kafka để <code>cmd</code> thực hiện kết nối để gửi request tạo topic</li><li><code>#3</code> với <code>--replication-factor</code> là số lượng replication để mỗi partition sễ được nhận rộng lên bao nhiêu. <ul><li>Là trị là số và phải ở giữa <code>1 và 32767</code></li><li>Số lượng phải nhỏ hơn hoặc bằng với số lượng Broker</li><li>Nếu không có parma này, default sẽ được lấy ở config trong Broker <code>default.replication.factor</code></li></ul></li><li><code>#4</code> với <code>--partitions 1</code> là số lượng partition cho topic này. Với số lượng cần lớn hơn <code>0</code><ul><li>Nếu không có parm này thì default sẽ được lấy trong <code>num.partitions</code></li></ul></li></ul><h3 id="segments" tabindex="-1">Segments <a class="header-anchor" href="#segments" aria-label="Permalink to &quot;Segments&quot;">​</a></h3><ul><li>Như chúng ta đã biết Broker sẽ thêm các Record vào các partition. Tuy nhiên Broker sẽ không thêm vào một tập partition duy nhất, nếu làm vậy tệp partition này sẽ khổng lồ.</li><li>Broker sẽ chia thành các tệp nhỏ thành các phần riêng biệt và được gọi là segments. <img src="/assets/kafka-partition-log-segments.48Zu1TVk.png" alt="kafka-partition-log-segments.png"><img src="/assets/kafka-partition-log-segments-file.24ReTyft.png" alt="kafka-partition-log-segments-file.png"></li><li>Việc sử dụng Segments sẽ giúp thực hiện push Record mới và thực hiện truy suất Record bằng offset trở lên dễ dàng hơn.</li><li>Mặc định kafka Broker sẽ để mỗi segment là một <a href="https://docs.confluent.io/platform/current/installation/configuration/topic-configs.html#segment-bytes" target="_blank" rel="noreferrer">1G</a> hoặc chúng ta có thể chỉ định ở <code>segment.bytes</code>. Khi đến ngưỡng segment sẽ được close và một segment mới được tạo. <ul><li>Kích thước segment nhỏ hơn có nghĩa là các tệp phải được đóng và phân bổ thường xuyên hơn, điều này làm giảm hiệu quả chung của việc ghi đĩa.</li></ul></li><li>Khi một segment bị close nó có thể được coi là expire(Hết hạn, bởi vì dữ liệu đã tồn tại quá lâu), việc điều chỉnh kích thước của các segment cũng rất quan trọng.</li><li>Chúng ta cũng có 1 config nữa đó là <code>segment.ms</code>, đây là thời gian nếu <code>segment</code> chưa đến ngưỡng giới hạn dung lượng thì kafka cũng sẽ close segment và tạo ra một segment mới. Default là 1 tuần.</li><li>Lưu ý : <code>segment.ms</code> và <code>segment.bytes</code> là config của từng topic</li><li><a href="https://kafka.apache.org/30/generated/topic_config.html" target="_blank" rel="noreferrer">Danh sách biến topic config</a></li></ul><h4 id="vi-du-ve-segments-cua-mot-partition-index" tabindex="-1">Ví dụ về segments của một partition index. <a class="header-anchor" href="#vi-du-ve-segments-cua-mot-partition-index" aria-label="Permalink to &quot;Ví dụ về segments của một partition index.&quot;">​</a></h4><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>- kafka-topics --bootstrap-server kafka1:19091 --create --if-not-exists --topic topicName --replication-factor 1 --partitions 4  --config segment.bytes=1048576 # 1MB</span></span>
<span class="line"><span></span></span>
<span class="line"><span>topic-rep-1-partition-10-7</span></span>
<span class="line"><span>├── 00000000000000000000.index</span></span>
<span class="line"><span>├── 00000000000000000000.log</span></span>
<span class="line"><span>├── 00000000000000000000.timeindex</span></span>
<span class="line"><span>├── 00000000000000023576.index</span></span>
<span class="line"><span>├── 00000000000000023576.log</span></span>
<span class="line"><span>├── 00000000000000023576.snapshot</span></span>
<span class="line"><span>├── 00000000000000023576.timeindex</span></span>
<span class="line"><span>├── 00000000000000046988.index</span></span>
<span class="line"><span>├── 00000000000000046988.log</span></span>
<span class="line"><span>├── 00000000000000046988.snapshot</span></span>
<span class="line"><span>├── 00000000000000046988.timeindex</span></span>
<span class="line"><span>├── leader-epoch-checkpoint</span></span>
<span class="line"><span>└── partition.metadata</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h6 id="cac-file-segment" tabindex="-1">Các file Segment <a class="header-anchor" href="#cac-file-segment" aria-label="Permalink to &quot;Các file Segment&quot;">​</a></h6><ul><li>Nhìn vào ví dụ trên chúng ta có thể thấy đây là Segment cho partition index <code>7</code> của topic <code>topic-rep-1-partition-10</code>.</li><li>Hiện có 3 Segment, <code>Segment 1</code> bắt đầu từ <code>0</code>, <code>Segment 2</code> bắt đầu từ <code>23576</code> và <code>Segment 3</code> bắt đầu từ <code>46988</code>.</li></ul><h6 id="file-leader-epoch-checkpoint" tabindex="-1">File leader-epoch-checkpoint <a class="header-anchor" href="#file-leader-epoch-checkpoint" aria-label="Permalink to &quot;File leader-epoch-checkpoint&quot;">​</a></h6><ul><li>File <code>leader-epoch-checkpoint</code> sẽ lưu lại lịch sử chuyển đổi leader của một partition.</li><li>Ví dụ:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>1 0</span></span>
<span class="line"><span>2 150</span></span>
<span class="line"><span>3 300</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Có 2 giá trị mỗi Line.</p><ul><li>Giá trị đầu tiên là &quot;leader epoch&quot; tương ứng với một khoảng thời gian mà một broker giữ vai trò leader của phân vùng.</li><li>Giá trị thứ 2 là <code>start-offset</code> cho biết offset bắt đầu cho leader mới quản lý dữ liệu trong partition</li></ul><h6 id="file-partition-metadata" tabindex="-1">File partition.metadata <a class="header-anchor" href="#file-partition-metadata" aria-label="Permalink to &quot;File partition.metadata&quot;">​</a></h6><ul><li>File <code>partition.metadata</code> sẽ lưu lại một số thông tin của partition</li><li>Ví dụ:</li></ul><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>version: 0</span></span>
<span class="line"><span>topic_id: X6KL_lg2R4a7JkuZYScQxg</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h5 id="segments-position-index" tabindex="-1">Segments position index <a class="header-anchor" href="#segments-position-index" aria-label="Permalink to &quot;Segments position index&quot;">​</a></h5><ul><li>Kafka cho phép chúng ta tìm kiếm theo 2 cách: <code>offset</code> và <code>timestamp</code> tương ứng dụng file <code>.index</code> và <code>.timeindex</code><ul><li>File <code>.index</code> phục vụ cho tìm kiếm nhanh chóng Record bằng <code>offset</code> trong file <code>.log</code> của Segment.</li><li>File <code>.timeindex</code> phục vụ cho tìm kiếm nhanh chóng Record bằng <code>timestamp</code> trong file <code>.log</code> của Segment.</li></ul></li></ul><h3 id="cau-hinh-cleanup-policy" tabindex="-1">Cấu hình <code>cleanup.policy</code> <a class="header-anchor" href="#cau-hinh-cleanup-policy" aria-label="Permalink to &quot;Cấu hình `cleanup.policy`&quot;">​</a></h3><ul><li>Khi có Record mới, Producer vẫn tiếp tục được gửi đến Broker, Broker sẽ cần xóa các Record cũ hơn để giải phóng dung lượng trên hệ thống.</li><li><code>cleanup.policy</code> là cấu hình cách thức Kafka quản lý và dọn dẹp các Record cũ của topic sau khi đã được ghi vào.</li><li>Cấu hình này ảnh hưởng trực tiếp đến cách Kafka xử lý việc lưu trữ và duy trì các Record trong các partition.</li></ul><h4 id="cac-gia-tri-cua-cleanup-policy" tabindex="-1">Các giá trị của <code>cleanup.policy</code> <a class="header-anchor" href="#cac-gia-tri-cua-cleanup-policy" aria-label="Permalink to &quot;Các giá trị của `cleanup.policy`&quot;">​</a></h4><ul><li><code>cleanup.policy=delete</code>: Đây là giá trị mặc định nếu không cấu hình. <ul><li>Cấu hình này được thiết lập, Kafka sẽ xóa các Record khỏi log sau khi chúng vượt qua giới hạn thời gian lưu trữ hoặc dung lượng lưu trữ được quy định bởi các cấu hình như <code>retention.ms (thời gian lưu trữ)</code> hoặc <code>retention.bytes (kích thước lưu trữ)</code>.</li><li><code>cleanup.policy=delete</code> phù hợp với các topic cần giữ dữ liệu tạm thời hoặc chỉ trong một khoảng thời gian nhất định.<details class="details custom-block"><summary>ví dụ thực tế</summary><p>Record ghi lại hành động của người dùng. Hành động của người dùng là data quá khứ và nó có thể lưu ở các hệ thống Big data chứ không cần lưu mãi mãi trên Kafka.</p></details></li></ul></li><li><code>cleanup.policy=compact</code><ul><li>Cấu hình này Kafka sẽ xóa các dữ liệu cũ bằng cách nén(<code>compact</code>) các Record, chỉ các Record có giá trị mới nhất cho mỗi key. Những Record cũ hơn có cùng Key sẽ bị loại bỏ.</li><li>Hiểu đơn giản chỉ giữ lại các Record cuối cùng của các Key.</li><li><code>compact</code> rất hữu ích với các Topic có dữ liệu dạng Key/Value với yêu cầu chỉ giữ lại Record cuối cùng cho mỗi Key.</li><li>Các Record không có key sẽ không được nén, vì vậy nếu sử dụng <code>compact</code> thì các Record không có Key sẽ được lưu vĩnh viễn.<details class="details custom-block"><summary>ví dụ thực tế</summary><p>Record update thông tin người dùng. Mỗi người dùng có định danh duy nhất bởi <code>user_id</code>. Kafka sẽ giữ lại Record mới nhất cho mõi <code>user_id</code> vì đây là dữ liệu mới nhất, các Record cũ sẽ bị xóa.</p></details></li></ul></li><li>Kết hợp cả <code>compact</code> và <code>delete</code> bằng cách <code>cleanup.policy=compact,delete</code>. <ul><li>Khi cấu hình cả <code>compact</code> và <code>delete</code>. Kafka sẽ thực hiện cả 2 quá trình : Nén Record dựa trên key và xóa các Record cũ sau một khoảng thời gian nhất định(<code>Time-Based Policy</code>) hoặc đạt Size-Based Policy.</li><li>Đây là sự kết hợp giữa việc giữ lại Record mới nhất theo Key và xóa các Record không cần thiết sau khi chúng vượt quá giới hạn lưu trữ.<details class="details custom-block"><summary>ví dụ thực tế Kết hợp cả compact và delete</summary><ul><li>Ví dụ: <code>Một hệ thống quản lý state của người dùng</code> và <code>cần lưu trữ state mới nhất của mỗi user</code>(Dựa trên user_id) là key. Đồng thời để tiết kiệm dung lượng ổ cứng chúng ta sẽ xóa các Record sau 1 khoảng thời gian nhất định.</li><li>Kịch bản: <ul><li>Mỗi lần người dùng thực hiện 1 action thay đổi state, hệ thoống sẽ ghi một Record vào kafka với <code>user_id</code> là key và state mới là giá trị.</li><li>Khi cần truy vấn thông tin người dùng, luôn lấy được trạng thái mới nhất của người dùng(<code>user_id</code>) nên cần giữ state mới nhất của user.(sử dụng cơ chế compaction)</li><li>Tuy nhiên, cũng muốn giới hạn dung lượng log Kafka và xóa những Record không có key hoặc không cần thiết sau một khoảng thời gian nhất định (sử dụng cơ chế delete).</li></ul></li><li>Cấu hình <code>cleanup.policy=compact,delete</code><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>kafka-topics.sh --create --topic user-status --bootstrap-server localhost:9092 \</span></span>
<span class="line"><span>  --config cleanup.policy=compact,delete \</span></span>
<span class="line"><span>  --config retention.ms=604800000 \ # 7 ngày</span></span>
<span class="line"><span>  --config retention.bytes=1073741824 \ # 1GB</span></span>
<span class="line"><span>  --config min.cleanable.dirty.ratio=0.5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li><li>Giải thích cấu hình: <ul><li><code>cleanup.policy=compact,delete</code>: Kết hợp cả hai chính sách. <ul><li><code>compact</code>: Kafka sẽ nén log, giữ lại Record mới nhất cho mỗi user_id.</li><li><code>delete</code>: Kafka sẽ xóa các Record cũ khi chúng vượt quá thời gian lưu trữ (7 ngày) hoặc khi dung lượng log đạt đến 1GB.</li></ul></li><li><code>retention.ms=604800000</code>: Các Record sẽ được giữ trong 7 ngày, sau đó Kafka sẽ xóa chúng.</li><li><code>retention.bytes=1073741824</code>: Khi kích thước của log đạt 1GB, Kafka sẽ bắt đầu xóa các Record cũ để giải phóng không gian lưu trữ.</li><li><code>min.cleanable.dirty.ratio=0.5</code>: Kafka sẽ bắt đầu quá trình compaction khi log bẩn (dirty) chiếm ít nhất 50% dung lượng log.</li></ul></li><li>Lợi ích của việc kết hợp <code>compact và delete:</code><ul><li><code>Nén log (compaction)</code>: Kafka sẽ chỉ giữ lại Record mới nhất cho mỗi <code>user_id</code>, giúp tiết kiệm dung lượng log và dễ dàng lấy được trạng thái mới nhất của người dùng.</li><li><code>Xóa log (delete)</code>: Những Record không có key, hoặc các Record cũ hơn 7 ngày hoặc vượt quá dung lượng 1GB sẽ bị xóa, giúp giảm thiểu việc tiêu tốn dung lượng lưu trữ không cần thiết.</li><li>Điều này đảm bảo Kafka không lưu trữ những dữ liệu cũ hoặc không cần thiết quá lâu, nhưng vẫn duy trì tính toàn vẹn của dữ liệu trạng thái mới nhất qua cơ chế compaction.</li></ul></li></ul></details></li></ul></li></ul><h4 id="_2-cach-thuc-quan-ly-record-cleanup-policy-delete" tabindex="-1">2 cách thức quản lý Record <code>cleanup.policy=delete</code> <a class="header-anchor" href="#_2-cach-thuc-quan-ly-record-cleanup-policy-delete" aria-label="Permalink to &quot;2 cách thức quản lý Record `cleanup.policy=delete`&quot;">​</a></h4><ul><li>Với cách này trong kafka sẽ gọi chung là <code>Retention</code> bởi vì Kafka quản lý điều này thông qua cơ chế <code>Retention policy(Chính sách lưu trữ)</code></li></ul><h5 id="retention-time-based-policy-chinh-sach-dua-tren-thoi-gian-luu-tru" tabindex="-1">Retention Time-Based Policy (Chính sách dựa trên thời gian lưu trữ) <a class="header-anchor" href="#retention-time-based-policy-chinh-sach-dua-tren-thoi-gian-luu-tru" aria-label="Permalink to &quot;Retention Time-Based Policy (Chính sách dựa trên thời gian lưu trữ)&quot;">​</a></h5><ul><li>Kafka cho phép chúng ta cấu hình thời gian lưu trữ Record(<code>(retention time</code>) thông qua cấu hình <code>retention.ms</code></li><li>Khi dữ liệu (Record) đã được lưu trong Kafka vượt quá thời gian quy định, nó sẽ được xóa trong quá trình dọn dẹp dữ liệu (log cleanup). Ví dụ:</li></ul><div class="language-properties vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">retention.ms</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=604800000 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 7 ngày (đơn vị ms) ==&gt; Sau 7 ngày, Kafka sẽ xóa các record cũ.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>Default giá trị <code>retention.ms</code> là <code>retention.ms</code> = 168 giờ.</li></ul><h5 id="retention-size-based-policy-chinh-sach-dua-tren-kich-thuoc-du-lieu" tabindex="-1">Retention Size-Based Policy (Chính sách dựa trên kích thước dữ liệu) <a class="header-anchor" href="#retention-size-based-policy-chinh-sach-dua-tren-kich-thuoc-du-lieu" aria-label="Permalink to &quot;Retention Size-Based Policy (Chính sách dựa trên kích thước dữ liệu)&quot;">​</a></h5><ul><li>Kafka cho phép chúng ta cấu hình Kafka để xóa các record cũ khi tổng kích thước của log segment vượt quá một ngưỡng nhất định.</li><li>Cấu hình <code>retention.bytes</code> quy định dung lượng tối đa mà Kafka lưu trữ cho mỗi partition.</li></ul><div class="language-properties vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">properties</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">retention.bytes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=1073741824 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1 GB ==&gt; Nếu partition vượt quá 1 GB, Kafka sẽ xóa các record cũ.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><ul><li>Default giá trị <code>retention.bytes</code> là <code>-1</code> tức không có giới hạn dung lượng, chỉ có giới hạn thời gian.</li></ul><h5 id="ket-hop-ca-time-based-policy-va-size-based-policy" tabindex="-1">Kết hợp cả Time-Based Policy và Size-Based Policy <a class="header-anchor" href="#ket-hop-ca-time-based-policy-va-size-based-policy" aria-label="Permalink to &quot;Kết hợp cả Time-Based Policy và Size-Based Policy&quot;">​</a></h5><ul><li>Chúng ta có thể kết hợp cả <code>Time-Based Policy và Size-Based Policy</code> để đảm bảo Record có thể xóa bởi cả 2 Policy.</li><li>Kết hợp cả <code>Time-Based Policy và Size-Based Policy</code> đảm bảo Record cũ sau một khoảng thời gian nhất định hoặc khi đến ngưỡng dung lượng sẽ bị xóa.</li></ul><p><img src="/assets/retention-policy.kgRIwcdP.webp" alt="retention-policy.png"></p><h5 id="luu-tru-du-lieu-mai-mai" tabindex="-1">Lưu trữ dữ liệu mãi mãi. <a class="header-anchor" href="#luu-tru-du-lieu-mai-mai" aria-label="Permalink to &quot;Lưu trữ dữ liệu mãi mãi.&quot;">​</a></h5><ul><li>Nếu bạn muốn dữ liệu kafka được lưu mãi mãi bạn có thể cấu hình giá trị <code>-1</code> cho <code>retention.ms</code> và <code>retention.bytes</code>.</li></ul><h2 id="tiered-storage" tabindex="-1"><a href="https://cwiki.apache.org/confluence/display/KAFKA/KIP-405%3A+Kafka+Tiered+Storage" target="_blank" rel="noreferrer">Tiered storage</a> <a class="header-anchor" href="#tiered-storage" aria-label="Permalink to &quot;[Tiered storage](https://cwiki.apache.org/confluence/display/KAFKA/KIP-405%3A+Kafka+Tiered+Storage)&quot;">​</a></h2><p>Mặc định Kafka sẽ lưu trữ dữ liệu trên ổ cứng, điều này giúp kafka nhanh chóng và hiệu quả trong việc ghi và đọc dữ liệu. Tuy nhiên, việc lưu trữ dữ liệu trên ổ cứng cũng tạo ra một số vấn đề như dung lượng lưu trữ, chi phí lưu trữ, v.v.</p><p><code>Tiered storage</code> là một cơ chế cho phép Kafka lưu trữ dữ liệu trên remote storage như Amazon S3, HDFS. Giúp dữ liệu của Kafka có thể lưu trữ lâu dài hơn.</p><p>Thực tế Kafka thường đọc dữ liệu ở cuối log segment(<a href="https://en.wikipedia.org/wiki/Page_cache" target="_blank" rel="noreferrer">Tail reads</a>), hiếm khi chúng ta thực hiện đọc lại dữ liệu ở giữa hoặc đầu log segment. Ngoại trừ trường hợp có lỗi xảy ra và cần phải đọc lại dữ liệu.</p><p>Tail reads sẽ tận dụng tốt được sự hỗ trợ của OS bằng việc co thể đọc từ cache thay vì từ DISK. Dữ liệu cũ hơn sẽ được đọc ở DISK.</p><p>Tiered storage sẽ giúp Kafka lưu trữ dữ liệu ở 2 tires, local và remote.</p><ul><li>Local tier: Dữ liệu mới nhất và chưa được sử dụng sẽ được lưu trữ ở local tier, giúp Kafka đọc và ghi dữ liệu nhanh chóng.</li><li>Remote tier: Dữ liệu cũ hơn và đã được sử dụng sẽ được lưu trữ ở remote tier, giúp giảm chi phí lưu trữ và dung lượng ổ cứng.</li></ul><p>Khi bật tiered storage, retention policy sẽ được áp dụng riêng cho local và remote tier. Ví dụ ở local thời gian lưu trữ là 7 ngày, còn ở remote tier thời gian lưu trữ là 90 ngày.</p><h2 id="cluster-metadata" tabindex="-1">Cluster Metadata <a class="header-anchor" href="#cluster-metadata" aria-label="Permalink to &quot;Cluster Metadata&quot;">​</a></h2><p>KAFKA là một hệ thống phân tán, mọi hoạt động và state trong cluster đều yêu cầu metadata, Kafka sử dụng Zookeeper để lưu trữ metadata và các phiên bản mới hơn hỗ trợ thêm KR (Kafka Raft) để lưu trữ metadata.</p><p>Zookeeper hoặc Kafka Raft sẽ cho phép các Broker Kafka cùng tham gia vào một cluster, để cùng quản lý các topic, partition, offset, v.v.</p><p>Các metadata trong một cluster Kafka có thể bao gồm:</p><ul><li>Cluster Membership: Tham gia vào cluster và duy trì tư cách thành viên trong cluster. Nếu một broker không khả dụng(unavailable) Zookeeper hoặc Kafka Raft sẽ xóa broker đó khỏi thành viên trong cluster.</li></ul><h2 id="leaders-and-followers" tabindex="-1">Leaders and followers <a class="header-anchor" href="#leaders-and-followers" aria-label="Permalink to &quot;Leaders and followers&quot;">​</a></h2><p>Thực tế các partition không nằm trên một broker, Partition sẽ được chải ra trên các broker khác nhau trong cluster. Mỗi partition sẽ có một broker đóng vai trò là leader và các broker khác sẽ đóng vai trò là follower. (replication)</p><p><img src="/assets/Leaders-and-followers.1Rjyedj-.png" alt="Leaders-and-followers.png"></p><p>Partition leader sẽ sử lý tất cả các yêu cầu ghi và đọc từ client, các follower sẽ sao chép dữ liệu từ leader. Kafk sử dụng cơ chế <code>Leader-based Replication</code> để sao chép dữ liệu từ leader đến follower để đảm bảo tính toàn vẹn và đồng bộ dữ liệu.</p><p>Hãy nhớ rằng, một Topic sẽ có nhiều partition và mỗi partition sẽ có một leader và một số follower. Một Kafka Broker có thể đóng vai trò là leader cho một partition và follower cho partition khác.(Cùng hoặc khác topic)</p><p>Và một điều quan trọng là các Leader và Follower sẽ được chuyển đổi khi Leader không khả dụng hoặc cấu hình thủ công chuyển đổi.</p><h2 id="replication" tabindex="-1">Replication <a class="header-anchor" href="#replication" aria-label="Permalink to &quot;Replication&quot;">​</a></h2><p>Kafka sử dụng cơ chế <code>Leader-based Replication</code> để sao chép dữ liệu từ leader đến follower để đảm bảo tính toàn vẹn và đồng bộ dữ liệu.</p><p>Khi một Record được ghi vào leader, leader sẽ gửi Record đó đến tất cả các follower. Khi tất cả các follower đã xác nhận đã nhận được Record, leader sẽ gửi ACK cho producer.</p><p>Khi một Broker Leader không khả dụng, Kafka sẽ chuyển đổi một follower khác trở thành leader, bởi vì các follower đều có dữ liệu đồng bộ với leader nên việc chuyển đổi sẽ không ảnh hưởng đến tính toàn vẹn dữ liệu</p><p><img src="/assets/Replication.YhSmuiWi.png" alt="Replication.png"></p><p>Tuy nhiên việc đồng bộ luôn sẽ có độ trễ. Nhìn minh họa dưới đây.</p><p><img src="/assets/Replication-lag.Kxkka3FU.png" alt="Replication-lag.png"></p><p>Trong thực tế, một độ chễ nhỏ khoảng vài bản khi không phải là vấn đề, nhưng nếu độ chễ quá lớn có thể dẫn đến mất dữ liệu.=========</p><p>Khi dữ liệu ở followers bắt kịp với Leaders thì nó được coi là ISR <a href="https://www.geeksforgeeks.org/understanding-in-sync-replicas-isr-in-apache-kafka/" target="_blank" rel="noreferrer">(In-Sync Replicas) </a>. Hiểu đơn giản ISR là các follower đã đồng bộ đầy đủ dữ liệu với leader.</p><h2 id="mot-so-luu-y-ve-kafka-brokers" tabindex="-1">Một số lưu ý về Kafka Brokers <a class="header-anchor" href="#mot-so-luu-y-ve-kafka-brokers" aria-label="Permalink to &quot;Một số lưu ý về Kafka Brokers&quot;">​</a></h2><ul><li>Nếu tạo một Cluster kafka thì độ trễ của network nên ở mức dưới 15ms, vì việc liên lạc giữa các Kafka brokers là rất nhiều (Cả zookeeper nếu sử dụng zookeeper )</li></ul><h1 id="ref" tabindex="-1">REF: <a class="header-anchor" href="#ref" aria-label="Permalink to &quot;REF:&quot;">​</a></h1><ul><li><a href="https://ibm-cloud-architecture.github.io/refarch-eda/technology/kafka-overview/" target="_blank" rel="noreferrer">https://ibm-cloud-architecture.github.io/refarch-eda/technology/kafka-overview/</a></li><li><strong>Kafka book</strong>: <a href="/study/thanhlv-study-2024/static/Kafka%20Event%20Streaming%20Platform%20In%20Action.pdf">Kafka Event Streaming Platform In Action.pdf</a></li></ul></div></div><div class="author" data-v-81aadc3d><div class="aside-container" style="margin:auto;text-align:center;width:auto;" data-v-81aadc3d><!--[--><!--[--><!--[--><div><a class="sponsors-aside-text">Tác giả</a><div class="VPTeamMembers small count-1" data-v-efccf3f0><div class="container" data-v-efccf3f0><!--[--><div class="item" data-v-efccf3f0><article class="VPTeamMembersItem small" data-v-efccf3f0 data-v-4c50b85b><div class="profile" data-v-4c50b85b><figure class="avatar" data-v-4c50b85b><img class="avatar-img" src="/images/avatar/thanhlv.jpg" alt="Lê Văn Thành" data-v-4c50b85b></figure><div class="data" data-v-4c50b85b><h1 class="name" data-v-4c50b85b>Lê Văn Thành</h1><p class="affiliation" data-v-4c50b85b><span class="title" data-v-4c50b85b>Java engineer và App engineer tại Line</span><!----><!----></p><!----><div class="links" data-v-4c50b85b><div class="VPSocialLinks" data-v-4c50b85b data-v-a14f2e61><!--[--><a class="VPSocialLink no-icon" href="https://github.com/lethanh9398" aria-label="github" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink no-icon" href="https://linkedin.com/in/thanhlv-com" aria-label="linkedin" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>LinkedIn</title><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg></a><a class="VPSocialLink no-icon" href="https://www.facebook.com/lethanh9398" aria-label="facebook" target="_blank" rel="noopener" data-v-a14f2e61 data-v-2dba762f><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Facebook</title><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a><!--]--></div></div></div></div><!----></article></div><!--]--></div></div></div><!--]--><!--]--><!--]--></div></div><!----><div style="display:flex;" data-v-81aadc3d><p data-v-81aadc3d><a target="_blank" href="//www.dmca.com/Protection/Status.aspx?ID=8febc2ec-f016-49e9-8483-8b1afed383d4&amp;cdnrdr=1&amp;refurl=/study/thanhlv-study-2024/2024-06-10-kafka-brokers.html" title="DMCA.com Protection Status" class="dmca-badge"><img style="margin:auto;" class="no-zoom" src="https://images.dmca.com/Badges/dmca_protected_sml_120m.png?ID=8febc2ec-f016-49e9-8483-8b1afed383d4" alt="DMCA.com Protection Status"></a></p><!----><p class="VPLastUpdated" data-v-81aadc3d data-v-418ce2c4>Cập nhật lần cuối: <time datetime="2025-01-23T08:22:15.000Z" data-v-418ce2c4></time></p></div></main><!--[--><!--]--><footer class="VPContentDocFooter" data-v-81aadc3d data-v-e24d455a><!----><a class="next-link" href="/study/thanhlv-study-2024/gioi-thieu-ve-muc-tieu-hoc-tap-be-nam-2024-cua-thanh-lv.html" data-v-e24d455a><span class="desc" data-v-e24d455a>Bài tiếp theo <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="vt-link-icon" data-v-e24d455a><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></span><span class="title" data-v-e24d455a>Mục tiêu công nghệ của Thanhlv năm 2024</span></a></footer></div></div></div></div><div class="visually-hidden" aria-live="polite" data-v-06370823>Kafka Brokers là gì ? has loaded</div></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about_author_thanhlv_todo-list.md\":\"TLK51aWG\",\"study_thanhlv-study-2024_2024-04-21-event-stream-va-event-stream-platform-la-gi.md\":\"83i5Pb4V\",\"blog_2024-01-26-thread-ung-dung-phan-mem-va-thread-hardware-cpu-khac-gi-nhau.md\":\"gTYObFcJ\",\"blog_2024-01-10-concurrency-va-parallelism-giai-thich-concurrency-va-parallelism-cua-os-va-business-khac-gi-nhau.md\":\"8SDiXGBM\",\"blog_gioi-thieu.md\":\"BMITEsNw\",\"index.md\":\"m4TI0MPN\",\"short-blog_gioi-thieu.md\":\"vp9ooRLx\",\"short-blog_2024-11-08-trong-java-6-7-8-loi-illegal-key-size-khi-dung-cipher-chua-chac-phai-do-ban-code-sai.md\":\"clY3HKRD\",\"about_author_thanhlv_my-note.md\":\"dWVuDiWx\",\"short-blog_2024-11-01-chung-toi-da-bi-tan-cong-phong-thu-thanh-cong-nhung-co-status-dac-biet-can-dieu-tra.md\":\"GUa9ApMy\",\"study_thanhlv-study-2024_2024-04-16-event-la-gi.md\":\"zOaczZXq\",\"study_thanhlv-study-2024_2024-04-19-stream-la-gi.md\":\"NX8TJf12\",\"about_author_thanhlv-vi.md\":\"-QGR-TqB\",\"blog_2024-12-05-y-nghia-cua-cac-http-status-code.md\":\"-Q_feHHC\",\"blog_2024-01-16-su-khac-biet-giua-import-wildcard-va-import-mot-class-trong-java.md\":\"VlTMgRNN\",\"study_thanhlv-study-2024_2024-04-15-message-queue-la-gi.md\":\"5UyoBOUG\",\"blog_2024-01-11-them-10-trieu-data-vao-cuoi-list-voi-array-list-va-linked-list-trong-java-thi-dung-cai-nao-nhanh-hon.md\":\"ZK4yea7x\",\"blog_2024-07-16-cac-cau-hoi-phong-van.md\":\"7_t8Z0-E\",\"blog_2024-01-17-sua-loi-404-khi-deploy-mot-so-ung-dung-web-single-page-application-voi-nginx.md\":\"fuEXrg5X\",\"study_thanhlv-study-2024_2024-03-14-internet-internet-hoat-dong-nhu-the-nao.md\":\"SKA3AHSE\",\"blog_2024-10-09-fallacies-of-distributed-computing-nhung-sai-lam-cua-khi-su-dung-distributed-computing.md\":\"-r_Qm-Ch\",\"study_tieng-anh_gioi-thieu.md\":\"azN6Rfy4\",\"study_thanhlv-study-2024_2024-04-15-message-la-gi.md\":\"K5Fggg2K\",\"study_tieng-anh_cac-tu-vung.md\":\"VkKptQ_7\",\"study_thanhlv-study-2024_2024-03-18-world-wide-web-la-gi.md\":\"o5kFa7mg\",\"study_thanhlv-study-2024_gioi-thieu-ve-muc-tieu-hoc-tap-be-nam-2024-cua-thanh-lv.md\":\"tZB2hWuw\",\"study_thanhlv-study-2024_2024-04-02-htpp-la-gi.md\":\"AAuVr8F5\",\"blog_2024-12-04-so-sanh-restfull-api-va-grpc-khi-nao-su-dung.md\":\"WM0n80y6\",\"study_thanhlv-study-2024_2024-05-16-cai-dat-kafka-voi-zookeeper-hoac-kraft.md\":\"SiSYv1HE\",\"study_thanhlv-study-2024_2024-06-10-kafka-brokers.md\":\"McwhZlSb\",\"blog_2024-01-09-cpu-core-and-thread-khac-gi-nhau.md\":\"XrxwQgVr\",\"blog_2024-01-31-tim-hieu-ve-design-pattern.md\":\"bp2m2wAd\",\"short-blog_2024-12-06-ngan-hang-van-chua-ap-dung-cong-nghe-cho-quy-trinh-de-phuc-vu-khach-hang.md\":\"97dxDXAa\",\"blog_2024-02-29-su-khac-biet-giua-design-patternsva-architechture.md\":\"qS0GemKD\",\"blog_2024-01-18-thread-safe-va-lock-object-la-gi.md\":\"XKkLHkbX\",\"study_thanhlv-study-2024_2024-04-24-so-sanh-message-va-event.md\":\"raNW-NFO\",\"blog_2024-02-01-tim-hieu-ve-architecture.md\":\"UmyN8yQW\",\"study_thanhlv-study-2024_2024-04-25-tim-hieu-lich-su-va-muc-dich-cua-kafka.md\":\"JAEKIKux\",\"blog_2024-08-07-kafka-producer-da-khong-con-round-robin-partition-voi-key-null.md\":\"z38UDNMO\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Yêu công nghệ - Khám Phá Công Nghệ - Thanhlv.com\",\"description\":\"Thanhlv.com - Nơi chia sẻ kiến thức yêu công nghệ và học hỏi công nghệ. Cập nhật những bài viết, hướng dẫn chi tiết về lập trình, công nghệ thông tin và những công nghệ mới nhất.\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Blog\",\"activeMatch\":\"^/blog/\",\"link\":\"/blog/gioi-thieu\"},{\"text\":\"Short Blog\",\"activeMatch\":\"^/short-blog/\",\"link\":\"/short-blog/gioi-thieu\"},{\"text\":\"Study\",\"activeMatch\":\"^/study/\",\"items\":[{\"text\":\"Học tập BE Thanhlv 2024\",\"link\":\"/study/thanhlv-study-2024/gioi-thieu-ve-muc-tieu-hoc-tap-be-nam-2024-cua-thanh-lv\"},{\"text\":\"Tiếng anh\",\"link\":\"/study/tieng-anh/gioi-thieu\"}]},{\"text\":\"About\",\"activeMatch\":\"^/about/\",\"items\":[{\"text\":\"Thanhlv\",\"link\":\"/about/author/thanhlv-vi\"}]}],\"sidebar\":{\"/blog/\":[{\"text\":\"\",\"items\":[{\"text\":\"Giới thiệu\",\"link\":\"/blog/gioi-thieu\"},{\"text\":\"Ý nghĩa của các HTTP Status Code\",\"date\":\"2024-12-05T00:00:00.000Z\",\"link\":\"/blog/2024-12-05-y-nghia-cua-cac-http-status-code.html\"},{\"text\":\"So sánh RESTful API và gRPC. Khi nào sử dụng?\",\"date\":\"2024-12-04T00:00:00.000Z\",\"link\":\"/blog/2024-12-04-so-sanh-restfull-api-va-grpc-khi-nao-su-dung.html\"},{\"text\":\"Fallacies of distributed computing - Những sai lầm khi sử dụng distributed computing\",\"date\":\"2024-10-09T00:00:00.000Z\",\"link\":\"/blog/2024-10-09-Fallacies-of-distributed-computing-nhung-sai-lam-cua-khi-su-dung-distributed-computing.html\"},{\"text\":\"Kafka producer đã không còn Round Robin Partition với key null\",\"date\":\"2024-07-16T00:00:00.000Z\",\"link\":\"/blog/2024-08-07-Kafka-producer-da-khong-con-Round-Robin-Partition-voi-key-null.html\"},{\"text\":\"Sự khác biệt giữa Design Pattern và Software Architecture.\",\"date\":\"2024-02-29T00:00:00.000Z\",\"link\":\"/blog/2024-02-29-su-khac-biet-giua-design-patternsva-architechture.html\"},{\"text\":\"Tìm hiểu về Architecture\",\"date\":\"2024-02-01T00:00:00.000Z\",\"link\":\"/blog/2024-02-01-tim-hieu-ve-architecture.html\"},{\"text\":\"Tìm hiểu về Design Pattern\",\"date\":\"2024-01-31T00:00:00.000Z\",\"link\":\"/blog/2024-01-31-tim-hieu-ve-design-pattern.html\"},{\"text\":\"Thread ứng dụng phần mềm và Thread hardware CPU khác gì nhau\",\"date\":\"2024-01-26T00:00:00.000Z\",\"link\":\"/blog/2024-01-26-thread-ung-dung-phan-mem-va-thread-hardware-cpu-khac-gi-nhau.html\"},{\"text\":\"Thread safe, Lock object là gì ?\",\"date\":\"2024-01-18T00:00:00.000Z\",\"link\":\"/blog/2024-01-18-thread-safe-va-lock-object-la-gi.html\"},{\"text\":\"Sửa lỗi 404 khi deploy một số ứng dụng web Single Page Application với Nginx\",\"date\":\"2024-01-17T00:00:00.000Z\",\"link\":\"/blog/2024-01-17-sua-loi-404-khi-deploy-mot-so-ung-dung-web-single-page-application-voi-nginx.html\"},{\"text\":\"Sự khác biệt giữa import wildcard và import một class trong java\",\"date\":\"2024-01-16T00:00:00.000Z\",\"link\":\"/blog/2024-01-16-su-khac-biet-giua-import-wildcard-va-import-mot-class-trong-java.html\"},{\"text\":\"Thêm 10 triệu data vào cuối list với ArrayList và LinkedList trong java thì dùng cái nào nhanh hơn\",\"date\":\"2024-01-11T00:00:00.000Z\",\"link\":\"/blog/2024-01-11-them-10-trieu-data-vao-cuoi-list-voi-array-list-va-linked-list-trong-java-thi-dung-cai-nao-nhanh-hon.html\"},{\"text\":\"Concurrency và parallelism. Giải thích Concurrency và parallelism của OS và business khác gì nhau ?.\",\"date\":\"2024-01-10T00:00:00.000Z\",\"link\":\"/blog/2024-01-10-concurrency-va-parallelism-giai-thich-concurrency-va-parallelism-cua-os-va-business-khac-gi-nhau.html\"},{\"text\":\"CPU, CORE và Thread khác gì nhau ?\",\"date\":\"2024-01-09T00:00:00.000Z\",\"link\":\"/blog/2024-01-09-cpu-core-and-thread-khac-gi-nhau.html\"}]}],\"/short-blog/\":[{\"text\":\"\",\"items\":[{\"text\":\"Giới thiệu\",\"link\":\"/short-blog/gioi-thieu\"},{\"text\":\"Ngân hàng vẫn chưa áp dụng công nghệ tốt cho quy trình để phục vụ khách hàng\",\"date\":\"2024-12-06T00:00:00.000Z\",\"link\":\"/short-blog/2024-12-06-ngan-hang-van-chua-ap-dung-cong-nghe-cho-quy-trinh-de-phuc-vu-khach-hang.html\"},{\"text\":\"Trong java 6 7 8 lỗi Illegal key size khi dùng Cipher chưa chắc phải do bạn code sai mà là do Java Policy JCE.\",\"date\":\"2024-11-08T00:00:00.000Z\",\"link\":\"/short-blog/2024-11-08-trong-java-6-7-8-loi-Illegal-key-size-khi-dung-Cipher-chua-chac-phai-do-ban-code-sai.html\"},{\"text\":\"Chúng tôi đã bị tấn công, phòng thủ thành công nhưng có status đặc biệt cần điều tra\",\"date\":\"2024-11-01T00:00:00.000Z\",\"link\":\"/short-blog/2024-11-01-chung-toi-da-bi-tan-cong-phong-thu-thanh-cong-nhung-co-status-dac-biet-can-dieu-tra.html\"}]}],\"/study/thanhlv-study-2024\":[{\"text\":\"Giới thiệu\",\"group\":\"Giới thiệu\",\"date\":\"2024-02-1\",\"items\":[{\"text\":\"Mục tiêu công nghệ của Thanhlv năm 2024\",\"date\":\"2024-02-1\",\"link\":\"/study/thanhlv-study-2024/gioi-thieu-ve-muc-tieu-hoc-tap-be-nam-2024-cua-thanh-lv.html\",\"group\":\"Giới thiệu\"}]},{\"text\":\"1. Internet\",\"group\":\"1. Internet\",\"date\":\"2024-03-14T00:00:00.000Z\",\"items\":[{\"text\":\"Internet hoạt động như thế nào?\",\"date\":\"2024-03-14T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-03-14-Internet-Internet-hoat-dong-nhu-the-nao.html\",\"group\":\"1. Internet\"},{\"text\":\"World wide web là gì ?\",\"date\":\"2024-03-18T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-03-18-world-wide-web-la-gi.html\",\"group\":\"1. Internet\"},{\"text\":\"HTTP là gì?\",\"date\":\"2024-04-02T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-02-htpp-la-gi.html\",\"group\":\"1. Internet\"}]},{\"text\":\"2. Message and event stream\",\"group\":\"2. Message and event stream\",\"date\":\"2024-04-15T00:00:00.000Z\",\"items\":[{\"text\":\"Message là gì ?\",\"date\":\"2024-04-15T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-15-message-la-gi.html\",\"group\":\"2. Message and event stream\"},{\"text\":\"Message queue là gì ?\",\"date\":\"2024-04-15T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-15-message-queue-la-gi.html\",\"group\":\"2. Message and event stream\"},{\"text\":\"Event là gì ?\",\"date\":\"2024-04-16T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-16-event-la-gi.html\",\"group\":\"2. Message and event stream\"},{\"text\":\"Stream là gì ?\",\"date\":\"2024-04-19T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-19-stream-la-gi.html\",\"group\":\"2. Message and event stream\"},{\"text\":\"Event stream và Event stream platform là gì ?\",\"date\":\"2024-04-21T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-21-event-stream-va-event-stream-platform-la-gi.html\",\"group\":\"2. Message and event stream\"},{\"text\":\"So sánh Message và Event.\",\"date\":\"2024-04-24T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-24-so-sanh-message-va-event.html\",\"group\":\"2. Message and event stream\"}]},{\"text\":\"2.1 Kafka\",\"group\":\"2.1 Kafka\",\"date\":\"2024-04-24T00:00:00.000Z\",\"items\":[{\"text\":\"Tìm hiểu lịch sử và mục đích của kafka\",\"date\":\"2024-04-24T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-04-25-tim-hieu-lich-su-va-muc-dich-cua-kafka.html\",\"group\":\"2.1 Kafka\"},{\"text\":\"Cài đặt Kafka với Zookeeper và Kraft\",\"date\":\"2024-05-16T00:00:00.000Z\",\"link\":\"/study/thanhlv-study-2024/2024-05-16-cai-dat-kafka-voi-zookeeper-hoac-KRaft.html\",\"group\":\"2.1 Kafka\"}]}],\"/study/tieng-anh\":[{\"text\":\"\",\"items\":[{\"text\":\"Giới thiệu\",\"date\":\"2024-03-14T00:00:00.000Z\",\"link\":\"/study/tieng-anh/gioi-thieu.html\"},{\"text\":\"Các từ vựng\",\"date\":\"2024-04-15T00:00:00.000Z\",\"link\":\"/study/tieng-anh/cac-tu-vung.html\"}]}],\"/about/author/thanhlv\":[{\"text\":\"Thông tin\",\"items\":[{\"text\":\"Cv Vietnames\",\"link\":\"/about/author/thanhlv-vi\"}]},{\"text\":\"Và....\",\"items\":[{\"text\":\"My note\",\"link\":\"/about/author/thanhlv/my-note.html\"},{\"text\":\"TODO list\",\"link\":\"/about/author/thanhlv/todo-list.html\"}]}]},\"algolia\":{\"indexName\":\"thanhlv\",\"appId\":\"O2PN3Z02M2\",\"apiKey\":\"b8303151f5f69276a688c1531f5cc803\",\"placeholder\":\"Tìm kiếm\",\"translations\":{\"button\":{\"buttonText\":\"Tìm kiếm\",\"buttonAriaLabel\":\"Tìm kiếm\"},\"modal\":{\"searchBox\":{\"resetButtonTitle\":\"Xóa tìm kiếm\",\"resetButtonAriaLabel\":\"Xóa tìm kiếm\",\"cancelButtonText\":\"Hủy tìm kiếm\",\"cancelButtonAriaLabel\":\"Hủy tìm kiếm\"},\"startScreen\":{\"recentSearchesTitle\":\"Gần đây\",\"noRecentSearchesText\":\"Không có tìm kiếm gần đây\",\"saveRecentSearchButtonTitle\":\"Lưu kết quả tìm kiếm này\",\"removeRecentSearchButtonTitle\":\"Xóa tìm kiếm này khỏi lịch sử\",\"favoriteSearchesTitle\":\"Yêu thích\",\"removeFavoriteSearchButtonTitle\":\"Xóa tìm kiếm này khỏi mục yêu thích\"},\"errorScreen\":{\"titleText\":\"Không tìm thấy kết quả\",\"helpText\":\"Dữ liệu không tồn tại hoặc kết nối mạng của bạn có vấn đề, vui lòng kiểm tra\"},\"footer\":{\"selectText\":\"Chọn để đọc\",\"navigateText\":\"Điều hướng\",\"closeText\":\"Đóng\",\"searchByText\":\"Tìm kiểm bởi\"},\"noResultsScreen\":{\"noResultsText\":\"Không có kết quả cho\",\"suggestedQueryText\":\"Hãy thử tìm kiếm\",\"reportMissingResultsText\":\"Bạn tin rằng truy vấn này sẽ trả về kết quả?\",\"reportMissingResultsLinkText\":\"Hãy cho tôi biết.\"}}}},\"i18n\":{\"toc\":\"Trên trang này\",\"previous\":\"Bài trước\",\"next\":\"Bài tiếp theo\",\"search\":\"Tìm kiếm\",\"returnToTop\":\"Cuộn lên đầu trang\"},\"footer\":{\"license\":{\"text\":\"MIT License\",\"link\":\"https://opensource.org/licenses/MIT\"},\"copyright\":\"Copyright © 2022-2025 ThanhLv\"}},\"locales\":{},\"scrollOffset\":[\"header\",\".VPLocalNav\"],\"cleanUrls\":false}");</script>
    
  </body>
</html>